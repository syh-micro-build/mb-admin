var X=Object.defineProperty;var D=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var T=(o,r,a)=>r in o?X(o,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[r]=a,W=(o,r)=>{for(var a in r||(r={}))Y.call(r,a)&&T(o,a,r[a]);if(D)for(var a of D(r))Z.call(r,a)&&T(o,a,r[a]);return o};var p=(o,r,a)=>new Promise((g,u)=>{var h=m=>{try{d(a.next(m))}catch(w){u(w)}},f=m=>{try{d(a.throw(m))}catch(w){u(w)}},d=m=>m.done?g(m.value):Promise.resolve(m.value).then(h,f);d((a=a.apply(o,r)).next())});import{i as ee,F as oe}from"./Form-DD94FbQq.js";import{p as i,m as z,n as te,o as se}from"./index-B3XF_MSj.js";import{u as ae}from"./useForm-B4UpeciK.js";import{_ as E}from"./Button.vue_vue_type_script_setup_true_lang-LFqjB6-P.js";import{u as L}from"./useIcon-DWxKCE_n.js";import{y as q,z as b,A as C,K as V,L as F,a4 as x,u as n,H as S,Q as ne,I as H,r as v,c as O,O as y,w as ie,o as le,R as re}from"./vue-chunks-DjkM_pWB.js";import{d as ce,s as de}from"./element-plus-ByljZuZM.js";const $=q({__name:"ActionButton",props:{showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),visible:i.bool.def(!0),searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","expand"],setup(o,{emit:r}){const a=r,g=()=>{a("search")},u=()=>{a("reset")},h=()=>{a("expand")};return(f,d)=>(b(),C(H,null,[o.showSearch?(b(),V(n(E),{key:0,type:"primary",loading:o.searchLoading,icon:n(L)({icon:"ep:search"}),onClick:g},{default:F(()=>d[0]||(d[0]=[x(" 查询 ")])),_:1},8,["loading","icon"])):S("",!0),o.showReset?(b(),V(n(E),{key:1,loading:o.resetLoading,plain:"",icon:n(L)({icon:"ep:refresh-right"}),onClick:u},{default:F(()=>d[1]||(d[1]=[x(" 重置 ")])),_:1},8,["loading","icon"])):S("",!0),o.showExpand?(b(),V(n(E),{key:2,icon:n(L)({icon:o.visible?"ep:arrow-up":"ep:arrow-down"}),text:"",onClick:h},{default:F(()=>[x(ne(o.visible?"收起":"展开"),1)]),_:1},8,["icon"])):S("",!0)],64))}}),Re=q({__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:i.bool.def(!1),labelWidth:i.oneOfType([String,Number]).def("auto"),layout:i.string.validate(o=>["inline","bottom"].includes(o)).def("inline"),buttonPosition:i.string.validate(o=>["left","center","right"].includes(o)).def("center"),showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),expandField:i.string.def(""),inline:i.bool.def(!0),removeNoValueItem:i.bool.def(!0),model:{type:Object,default:()=>({})},searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","register","validate"],setup(o,{expose:r,emit:a}){const g=o,u=a,h=v(!0),f=v(g.model),d=O(()=>{const e=n(c);let t=ce(e.schema);if(e.showExpand&&e.expandField&&!n(h)){const s=z(t,l=>l.field===e.expandField);t.map((l,U)=>(U>=s?l.hidden=!0:l.hidden=!1,l))}return e.layout==="inline"&&(t=t.concat([{field:"action",formItemProps:{labelWidth:"0px",slots:{default:()=>y("div",null,[y($,{showSearch:e.showSearch,showReset:e.showReset,showExpand:e.showExpand,searchLoading:e.searchLoading,resetLoading:e.resetLoading,visible:h.value,onExpand:B,onReset:A,onSearch:N},null)]),label:()=>y("span",null,[x(" ")])}}}])),t}),{formRegister:m,formMethods:w}=ae(),{getElFormExpose:R,getFormData:j,getFormExpose:K}=w,Q=v({}),k=v({}),c=O(()=>{const e=W({},g);return Object.assign(e,n(k)),e}),_=(e={})=>{k.value=Object.assign(n(k),e),Q.value=e},P=v([]);ie(()=>n(d),(...t)=>p(this,[...t],function*(e=[]){f.value=ee(e,n(f)),P.value=e}),{immediate:!0,deep:!0});const I=()=>p(this,null,function*(){const e=yield j();return n(c).removeNoValueItem?Object.keys(e).reduce((t,s)=>{const l=e[s];return te(l)||(se(l)?Object.keys(l).length>0&&(t[s]=l):t[s]=l),t},{}):e}),N=()=>p(this,null,function*(){const e=yield R();yield e==null?void 0:e.validate(t=>p(this,null,function*(){if(t){const s=yield I();u("search",s)}}))}),A=()=>p(this,null,function*(){const e=yield R();e==null||e.resetFields();const t=yield I();u("reset",t)}),G=O(()=>({textAlign:n(c).buttonPosition})),B=()=>p(this,null,function*(){h.value=!n(h)}),M={getElFormExpose:R,setProps:_,setSchema:e=>{const{schema:t}=n(c);for(const s of t)for(const l of e)s.field===l.field&&de(s,l.path,l.value)},setValues:(...t)=>p(this,[...t],function*(e={}){f.value=Object.assign(g.model,n(f),e);const s=yield K();s==null||s.setValues(e)}),delSchema:e=>{const{schema:t}=n(c),s=z(t,l=>l.field===e);s>-1&&t.splice(s,1)},addSchema:(e,t)=>{const{schema:s}=n(c);if(t!==void 0){s.splice(t,0,e);return}s.push(e)},getFormData:j};le(()=>{u("register",M)}),r(M);const J=(e,t,s)=>{u("validate",e,t,s)};return(e,t)=>(b(),C(H,null,[y(n(oe),{model:f.value,"is-custom":!1,"label-width":c.value.labelWidth,"hide-required-asterisk":"",inline:c.value.inline,"is-col":c.value.isCol,schema:P.value,onRegister:n(m),onValidate:J},null,8,["model","label-width","inline","is-col","schema","onRegister"]),o.layout==="bottom"?(b(),C("div",{key:0,style:re(G.value)},[y($,{"show-reset":c.value.showReset,"show-search":c.value.showSearch,"show-expand":c.value.showExpand,"search-loading":c.value.searchLoading,"reset-loading":c.value.resetLoading,visible:h.value,onExpand:B,onReset:A,onSearch:N},null,8,["show-reset","show-search","show-expand","search-loading","reset-loading","visible"])],4)):S("",!0)],64))}});export{Re as _};
