var O=Object.defineProperty;var B=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var N=(s,o,l)=>o in s?O(s,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[o]=l,F=(s,o)=>{for(var l in o||(o={}))X.call(o,l)&&N(s,l,o[l]);if(B)for(var l of B(o))j.call(o,l)&&N(s,l,o[l]);return s};var h=(s,o,l)=>new Promise((_,b)=>{var k=n=>{try{v(l.next(n))}catch(m){b(m)}},C=n=>{try{v(l.throw(n))}catch(m){b(m)}},v=n=>n.done?_(n.value):Promise.resolve(n.value).then(k,C);v((l=l.apply(s,o)).next())});import{_ as G}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DZAa89N6.js";import{_ as K}from"./Search.vue_vue_type_script_setup_true_lang-DhhmJhGd.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-Db15b7gR.js";import"./index-xo_7KU-l.js";/* empty css               */import{_ as W}from"./Table.vue_vue_type_script_lang-DtLxrXuY.js";/* empty css                        *//* empty css                    *//* empty css                  */import{g as Z,d as ee,s as te}from"./index-BgX8RH5e.js";import{u as ae}from"./useTable-CM-hTBqr.js";import{_ as le}from"./Write.vue_vue_type_script_setup_true_lang-Cs2iOUmm.js";import{_ as oe}from"./Detail.vue_vue_type_script_setup_true_lang-DV0c-Cw2.js";import{u as re}from"./useCrudSchemas-B-xaNBdY.js";import{_ as d}from"./Button.vue_vue_type_script_setup_true_lang-BYj7a4ro.js";import{C as ie}from"./element-plus-Dmwbteg1.js";import{q as ne,r as u,J as se,O as i,V as c,P as I,u as t,t as S,v as ue,R as p,x as me,i as M,S as T,X as V}from"./vue-chunks-CrLAACUV.js";import"./Icon-DclqZ7xF.js";/* empty css                */import"./Form-CLWE_s4w.js";/* empty css                     *//* empty css               */import"./el-radio-button-BHgH-k5q.js";/* empty css                        *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-Bl3sK_Xx.js";import"./style.css_vue_type_style_index_0_src_true_lang-DJsV4k-I.js";import"./wang-editor-FQ26JwTT.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-Ds3d3qMu.js";import"./IconPicker-DFTAmA39.js";/* empty css                      */import"./useForm-BEZ9iDNV.js";import"./useIcon-D3DYfh5f.js";/* empty css                        *//* empty css                         *//* empty css                  */import"./index-r2E1SBsS.js";import"./useValidator-Nt61Jv1p.js";import"./Descriptions-C558bDoI.js";import"./tree-Dgaev6Pi.js";const de={class:"mb-10px"},at=ne({__name:"ExampleDialog",setup(s){const o=u([]),{tableRegister:l,tableState:_,tableMethods:b}=ae({fetchDataApi:()=>h(this,null,function*(){const{currentPage:e,pageSize:a}=_,r=yield Z(F({pageIndex:t(e),pageSize:t(a)},t(D)));return{list:r.data.list,total:r.data.total}}),fetchDelApi:()=>h(this,null,function*(){return!!(yield ee(t(o)))})}),{loading:k,dataList:C,total:v,currentPage:n,pageSize:m}=_,{getList:$,getElTableExpose:Y,delList:H}=b,D=u({}),L=e=>{D.value=e,$()},U=se([{field:"selection",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{type:"selection"}},{field:"index",label:"序号",type:"index",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0}},{field:"title",label:"标题",search:{component:"Input"},form:{component:"Input",colProps:{span:24}},detail:{span:24}},{field:"author",label:"作者",search:{hidden:!0}},{field:"display_time",label:"创建时间",search:{hidden:!0},form:{component:"DatePicker",componentProps:{type:"datetime",valueFormat:"YYYY-MM-DD HH:mm:ss"}}},{field:"importance",label:"重要性",search:{hidden:!0},form:{component:"Select",componentProps:{style:{width:"100%"},options:[{label:"重要",value:3},{label:"良好",value:2},{label:"一般",value:1}]}},detail:{slots:{default:e=>i(ie,{type:e.importance===1?"success":e.importance===2?"warning":"danger"},{default:()=>[e.importance===1?"重要":e.importance===2?"良好":"一般"]})}}},{field:"pageviews",label:"阅读数",search:{hidden:!0},form:{component:"InputNumber",value:0}},{field:"content",label:"内容",search:{hidden:!0},table:{show:!1},form:{component:"Editor",colProps:{span:24}},detail:{span:24,slots:{default:e=>i("div",{innerHTML:e.content},null)}}},{field:"action",width:"260px",label:"操作",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{slots:{default:e=>i(I,null,[i(d,{type:"primary",onClick:()=>z(e.row,"edit")},{default:()=>[c("编辑")]}),i(d,{type:"success",onClick:()=>z(e.row,"detail")},{default:()=>[c("详情")]}),i(d,{type:"danger",onClick:()=>A(e.row)},{default:()=>[c("删除")]})])}}}]),{allSchemas:y}=re(U),f=u(!1),P=u(""),w=u(null),g=u(""),q=()=>{P.value="新增",w.value=null,f.value=!0,g.value=""},x=u(!1),A=e=>h(this,null,function*(){const a=yield Y();o.value=e?[e.id]:(a==null?void 0:a.getSelectionRows().map(r=>r.id))||[],x.value=!0,yield H(t(o).length).finally(()=>{x.value=!1})}),z=(e,a)=>{P.value=a==="edit"?"编辑":"详情",g.value=a,w.value=e,f.value=!0},E=u(),R=u(!1),J=()=>h(this,null,function*(){const e=t(E),a=yield e==null?void 0:e.submit();a&&(R.value=!0,(yield te(a).catch(()=>{}).finally(()=>{R.value=!1}))&&(f.value=!1,n.value=1,$()))});return(e,a)=>(S(),ue(I,null,[i(t(G),null,{default:p(()=>[i(t(K),{schema:t(y).searchSchema,onSearch:L,onReset:L},null,8,["schema"]),me("div",de,[i(t(d),{type:"primary",onClick:q},{default:p(()=>[c("新增")]),_:1}),i(t(d),{loading:x.value,type:"danger",onClick:a[0]||(a[0]=r=>A(null))},{default:p(()=>[c(" 删除 ")]),_:1},8,["loading"])]),i(t(W),{pageSize:t(m),"onUpdate:pageSize":a[1]||(a[1]=r=>M(m)?m.value=r:null),currentPage:t(n),"onUpdate:currentPage":a[2]||(a[2]=r=>M(n)?n.value=r:null),columns:t(y).tableColumns,data:t(C),loading:t(k),pagination:{total:t(v)},onRegister:t(l)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),i(t(Q),{modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=r=>f.value=r),title:P.value},{footer:p(()=>[g.value!=="detail"?(S(),T(t(d),{key:0,type:"primary",loading:R.value,onClick:J},{default:p(()=>[c(" 保存 ")]),_:1},8,["loading"])):V("",!0),i(t(d),{onClick:a[3]||(a[3]=r=>f.value=!1)},{default:p(()=>[c("关闭")]),_:1})]),default:p(()=>[g.value!=="detail"?(S(),T(le,{key:0,ref_key:"writeRef",ref:E,"form-schema":t(y).formSchema,"current-row":w.value},null,8,["form-schema","current-row"])):V("",!0),g.value==="detail"?(S(),T(oe,{key:1,"detail-schema":t(y).detailSchema,"current-row":w.value},null,8,["detail-schema","current-row"])):V("",!0)]),_:1},8,["modelValue","title"])],64))}});export{at as default};
