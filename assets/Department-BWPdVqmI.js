var q=Object.defineProperty;var E=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var F=(i,o,l)=>o in i?q(i,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[o]=l,I=(i,o)=>{for(var l in o||(o={}))G.call(o,l)&&F(i,l,o[l]);if(E)for(var l of E(o))J.call(o,l)&&F(i,l,o[l]);return i};var v=(i,o,l)=>new Promise((b,w)=>{var C=n=>{try{y(l.next(n))}catch(m){w(m)}},P=n=>{try{y(l.throw(n))}catch(m){w(m)}},y=n=>n.done?b(n.value):Promise.resolve(n.value).then(C,P);y((l=l.apply(i,o)).next())});import{_ as Q}from"./ContentWrap.vue_vue_type_script_setup_true_lang-D9ZYwY_m.js";import{_ as X}from"./Search.vue_vue_type_script_setup_true_lang-B_2owTsb.js";import{_ as Y}from"./Dialog.vue_vue_type_style_index_0_lang-DKmKXn3R.js";import"./index-Dm00DqMG.js";/* empty css               */import{_ as Z}from"./Table.vue_vue_type_script_lang-nRalCOQz.js";/* empty css                        *//* empty css                    *//* empty css                  */import{g as ee,a as te,d as ae,s as re}from"./index-DT80c_Pp.js";import{u as le}from"./useTable-P7daYOkq.js";import{_ as oe}from"./Write.vue_vue_type_script_setup_true_lang-BsMJLKRA.js";import{_ as se}from"./Detail.vue_vue_type_script_setup_true_lang-U8ve-TlF.js";import{u as ne}from"./useCrudSchemas-DdqHtvsp.js";import{_ as d}from"./Button.vue_vue_type_script_setup_true_lang-D1ETsFhR.js";import{C as U}from"./element-plus-CUBv5pjL.js";import{y as ie,r as u,W as ue,O as r,I as p,a4 as c,u as a,z as k,A as me,L as f,D as de,l as K,K as R,H as $}from"./vue-chunks-ChjHxF1G.js";import"./Icon-CIHeq9G0.js";/* empty css                */import"./Form-BN8xxI3B.js";/* empty css                     *//* empty css               */import"./el-radio-button-fwmNzcr9.js";/* empty css                        *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-Bajzogyo.js";import"./style.css_vue_type_style_index_0_src_true_lang-BoSZsHO0.js";import"./wang-editor-qsc5EwLN.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-Bhb2rVz4.js";import"./IconPicker-CHBLi1L-.js";/* empty css                      */import"./useForm-B-XnwWK2.js";import"./useIcon-BP5eu9a-.js";/* empty css                        *//* empty css                         *//* empty css                  */import"./index-IexVdnqg.js";import"./useValidator-Nt61Jv1p.js";import"./Descriptions-C5rBURxh.js";import"./tree-Dgaev6Pi.js";const pe={class:"mb-10px"},rt=ie({__name:"Department",setup(i){const o=u([]),{tableRegister:l,tableState:b,tableMethods:w}=le({fetchDataApi:()=>v(this,null,function*(){const{currentPage:t,pageSize:e}=b,s=yield te(I({pageIndex:a(t),pageSize:a(e)},a(V)));return{list:s.data.list,total:s.data.total}}),fetchDelApi:()=>v(this,null,function*(){return!!(yield ae(a(o)))})}),{loading:C,dataList:P,total:y,currentPage:n,pageSize:m}=b,{getList:T,getElTableExpose:H,delList:M}=w,V=u({}),z=t=>{V.value=t,T()},O=ue([{field:"selection",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{type:"selection"}},{field:"index",label:"序号",type:"index",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0}},{field:"id",label:"部门名称",table:{slots:{default:t=>r(p,null,[t.row.departmentName])}},form:{component:"TreeSelect",componentProps:{nodeKey:"id",props:{label:"departmentName"}},optionApi:()=>v(this,null,function*(){return(yield ee()).data.list})},detail:{slots:{default:t=>r(p,null,[t.departmentName])}}},{field:"status",label:"状态",search:{hidden:!0},table:{slots:{default:t=>{const e=t.row.status;return r(p,null,[r(U,{type:e===0?"danger":"success"},{default:()=>[e===1?"启用":"禁用"]})])}}},form:{component:"Select",componentProps:{options:[{value:0,label:"禁用"},{value:1,label:"启用"}]}},detail:{slots:{default:t=>r(p,null,[r(U,{type:t.status===0?"danger":"success"},{default:()=>[t.status===1?"启用":"禁用"]})])}}},{field:"createTime",label:"创建时间",search:{hidden:!0},form:{hidden:!0}},{field:"remark",label:"备注",search:{hidden:!0},form:{component:"Input",componentProps:{type:"textarea",rows:5},colProps:{span:24}},detail:{slots:{default:t=>r(p,null,[t.remark])}}},{field:"action",width:"260px",label:"操作",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{slots:{default:t=>r(p,null,[r(d,{type:"primary",onClick:()=>L(t.row,"edit")},{default:()=>[c("编辑")]}),r(d,{type:"success",onClick:()=>L(t.row,"detail")},{default:()=>[c("详情")]}),r(d,{type:"danger",onClick:()=>N(t.row)},{default:()=>[c("删除")]})])}}}]),{allSchemas:_}=ne(O),g=u(!1),x=u(""),S=u(null),h=u(""),W=()=>{x.value="新增",S.value=null,g.value=!0,h.value=""},A=u(!1),N=t=>v(this,null,function*(){const e=yield H();o.value=t?[t.id]:(e==null?void 0:e.getSelectionRows().map(s=>s.id))||[],A.value=!0,yield M(a(o).length).finally(()=>{A.value=!1})}),L=(t,e)=>{x.value=e==="edit"?"编辑":"详情",h.value=e,S.value=t,g.value=!0},B=u(),D=u(!1),j=()=>v(this,null,function*(){const t=a(B),e=yield t==null?void 0:t.submit();e&&(D.value=!0,(yield re(e).catch(()=>{}).finally(()=>{D.value=!1}))&&(g.value=!1,n.value=1,T()))});return(t,e)=>(k(),me(p,null,[r(a(Q),null,{default:f(()=>[r(a(X),{schema:a(_).searchSchema,onSearch:z,onReset:z},null,8,["schema"]),de("div",pe,[r(a(d),{type:"primary",onClick:W},{default:f(()=>e[5]||(e[5]=[c("新增")])),_:1}),r(a(d),{loading:A.value,type:"danger",onClick:e[0]||(e[0]=s=>N(null))},{default:f(()=>e[6]||(e[6]=[c(" 删除 ")])),_:1},8,["loading"])]),r(a(Z),{pageSize:a(m),"onUpdate:pageSize":e[1]||(e[1]=s=>K(m)?m.value=s:null),currentPage:a(n),"onUpdate:currentPage":e[2]||(e[2]=s=>K(n)?n.value=s:null),columns:a(_).tableColumns,data:a(P),loading:a(C),pagination:{total:a(y)},onRegister:a(l)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),r(a(Y),{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=s=>g.value=s),title:x.value},{footer:f(()=>[h.value!=="detail"?(k(),R(a(d),{key:0,type:"primary",loading:D.value,onClick:j},{default:f(()=>e[7]||(e[7]=[c(" 保存 ")])),_:1},8,["loading"])):$("",!0),r(a(d),{onClick:e[3]||(e[3]=s=>g.value=!1)},{default:f(()=>e[8]||(e[8]=[c("关闭")])),_:1})]),default:f(()=>[h.value!=="detail"?(k(),R(oe,{key:0,ref_key:"writeRef",ref:B,"form-schema":a(_).formSchema,"current-row":S.value},null,8,["form-schema","current-row"])):$("",!0),h.value==="detail"?(k(),R(se,{key:1,"detail-schema":a(_).detailSchema,"current-row":S.value},null,8,["detail-schema","current-row"])):$("",!0)]),_:1},8,["modelValue","title"])],64))}});export{rt as default};
