var W=Object.defineProperty;var B=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var I=(s,o,l)=>o in s?W(s,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[o]=l,N=(s,o)=>{for(var l in o||(o={}))j.call(o,l)&&I(s,l,o[l]);if(B)for(var l of B(o))q.call(o,l)&&I(s,l,o[l]);return s};var h=(s,o,l)=>new Promise((b,y)=>{var k=n=>{try{v(l.next(n))}catch(m){y(m)}},C=n=>{try{v(l.throw(n))}catch(m){y(m)}},v=n=>n.done?b(n.value):Promise.resolve(n.value).then(k,C);v((l=l.apply(s,o)).next())});import{_ as G}from"./ContentWrap.vue_vue_type_script_setup_true_lang-uxg05GhV.js";import{_ as J}from"./Search.vue_vue_type_script_setup_true_lang-BUPOYlH6.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-DYmYnPSW.js";import"./index-CpPXvcts.js";/* empty css               */import{_ as X}from"./Table.vue_vue_type_script_lang-bDOG_9qR.js";/* empty css                        *//* empty css                    *//* empty css                  */import{g as Z,d as ee,s as te}from"./index-DTpkSDTA.js";import{u as ae}from"./useTable-CnlX33uN.js";import{_ as le}from"./Write.vue_vue_type_script_setup_true_lang-NOMz4aZm.js";import{_ as oe}from"./Detail.vue_vue_type_script_setup_true_lang-DG9u2l3E.js";import{u as re}from"./useCrudSchemas-Cog1rf3Y.js";import{_ as d}from"./Button.vue_vue_type_script_setup_true_lang-BcpRA9lD.js";import{C as ie}from"./element-plus-ByljZuZM.js";import{y as ne,r as u,W as se,O as i,a4 as p,I as F,u as a,z as S,A as ue,L as c,D as me,l as H,K as L,H as R}from"./vue-chunks-DjkM_pWB.js";import"./Icon-DxmGWFfr.js";/* empty css                */import"./Form-qFzCb_0J.js";/* empty css                     *//* empty css               */import"./el-radio-button-DiBm5-nt.js";/* empty css                        *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-9ZroKL4y.js";import"./style.css_vue_type_style_index_0_src_true_lang-DMVgc3TM.js";import"./wang-editor-Osncebl8.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-C1l0QiS2.js";import"./IconPicker-CRJGKS8C.js";/* empty css                      */import"./useForm-cXUO3Anh.js";import"./useIcon-BxLqvSoy.js";/* empty css                        *//* empty css                         *//* empty css                  */import"./index-EzDBtegv.js";import"./useValidator-Nt61Jv1p.js";import"./Descriptions-8e72JjeY.js";import"./tree-V8lrdewf.js";const de={class:"mb-10px"},at=ne({__name:"ExampleDialog",setup(s){const o=u([]),{tableRegister:l,tableState:b,tableMethods:y}=ae({fetchDataApi:()=>h(this,null,function*(){const{currentPage:t,pageSize:e}=b,r=yield Z(N({pageIndex:a(t),pageSize:a(e)},a($)));return{list:r.data.list,total:r.data.total}}),fetchDelApi:()=>h(this,null,function*(){return!!(yield ee(a(o)))})}),{loading:k,dataList:C,total:v,currentPage:n,pageSize:m}=b,{getList:T,getElTableExpose:M,delList:Y}=y,$=u({}),A=t=>{$.value=t,T()},U=se([{field:"selection",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{type:"selection"}},{field:"index",label:"序号",type:"index",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0}},{field:"title",label:"标题",search:{component:"Input"},form:{component:"Input",colProps:{span:24}},detail:{span:24}},{field:"author",label:"作者",search:{hidden:!0}},{field:"display_time",label:"创建时间",search:{hidden:!0},form:{component:"DatePicker",componentProps:{type:"datetime",valueFormat:"YYYY-MM-DD HH:mm:ss"}}},{field:"importance",label:"重要性",search:{hidden:!0},form:{component:"Select",componentProps:{style:{width:"100%"},options:[{label:"重要",value:3},{label:"良好",value:2},{label:"一般",value:1}]}},detail:{slots:{default:t=>i(ie,{type:t.importance===1?"success":t.importance===2?"warning":"danger"},{default:()=>[t.importance===1?"重要":t.importance===2?"良好":"一般"]})}}},{field:"pageviews",label:"阅读数",search:{hidden:!0},form:{component:"InputNumber",value:0}},{field:"content",label:"内容",search:{hidden:!0},table:{show:!1},form:{component:"Editor",colProps:{span:24}},detail:{span:24,slots:{default:t=>i("div",{innerHTML:t.content},null)}}},{field:"action",width:"260px",label:"操作",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{slots:{default:t=>i(F,null,[i(d,{type:"primary",onClick:()=>z(t.row,"edit")},{default:()=>[p("编辑")]}),i(d,{type:"success",onClick:()=>z(t.row,"detail")},{default:()=>[p("详情")]}),i(d,{type:"danger",onClick:()=>V(t.row)},{default:()=>[p("删除")]})])}}}]),{allSchemas:w}=re(U),f=u(!1),P=u(""),_=u(null),g=u(""),K=()=>{P.value="新增",_.value=null,f.value=!0,g.value=""},x=u(!1),V=t=>h(this,null,function*(){const e=yield M();o.value=t?[t.id]:(e==null?void 0:e.getSelectionRows().map(r=>r.id))||[],x.value=!0,yield Y(a(o).length).finally(()=>{x.value=!1})}),z=(t,e)=>{P.value=e==="edit"?"编辑":"详情",g.value=e,_.value=t,f.value=!0},E=u(),D=u(!1),O=()=>h(this,null,function*(){const t=a(E),e=yield t==null?void 0:t.submit();e&&(D.value=!0,(yield te(e).catch(()=>{}).finally(()=>{D.value=!1}))&&(f.value=!1,n.value=1,T()))});return(t,e)=>(S(),ue(F,null,[i(a(G),null,{default:c(()=>[i(a(J),{schema:a(w).searchSchema,onSearch:A,onReset:A},null,8,["schema"]),me("div",de,[i(a(d),{type:"primary",onClick:K},{default:c(()=>e[5]||(e[5]=[p("新增")])),_:1}),i(a(d),{loading:x.value,type:"danger",onClick:e[0]||(e[0]=r=>V(null))},{default:c(()=>e[6]||(e[6]=[p(" 删除 ")])),_:1},8,["loading"])]),i(a(X),{pageSize:a(m),"onUpdate:pageSize":e[1]||(e[1]=r=>H(m)?m.value=r:null),currentPage:a(n),"onUpdate:currentPage":e[2]||(e[2]=r=>H(n)?n.value=r:null),columns:a(w).tableColumns,data:a(C),loading:a(k),pagination:{total:a(v)},onRegister:a(l)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),i(a(Q),{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=r=>f.value=r),title:P.value},{footer:c(()=>[g.value!=="detail"?(S(),L(a(d),{key:0,type:"primary",loading:D.value,onClick:O},{default:c(()=>e[7]||(e[7]=[p(" 保存 ")])),_:1},8,["loading"])):R("",!0),i(a(d),{onClick:e[3]||(e[3]=r=>f.value=!1)},{default:c(()=>e[8]||(e[8]=[p("关闭")])),_:1})]),default:c(()=>[g.value!=="detail"?(S(),L(le,{key:0,ref_key:"writeRef",ref:E,"form-schema":a(w).formSchema,"current-row":_.value},null,8,["form-schema","current-row"])):R("",!0),g.value==="detail"?(S(),L(oe,{key:1,"detail-schema":a(w).detailSchema,"current-row":_.value},null,8,["detail-schema","current-row"])):R("",!0)]),_:1},8,["modelValue","title"])],64))}});export{at as default};
