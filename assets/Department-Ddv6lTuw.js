var j=Object.defineProperty;var E=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var F=(i,o,r)=>o in i?j(i,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[o]=r,U=(i,o)=>{for(var r in o||(o={}))G.call(o,r)&&F(i,r,o[r]);if(E)for(var r of E(o))H.call(o,r)&&F(i,r,o[r]);return i};var v=(i,o,r)=>new Promise((y,b)=>{var C=n=>{try{h(r.next(n))}catch(m){b(m)}},P=n=>{try{h(r.throw(n))}catch(m){b(m)}},h=n=>n.done?y(n.value):Promise.resolve(n.value).then(C,P);h((r=r.apply(i,o)).next())});import{_ as J}from"./ContentWrap.vue_vue_type_script_setup_true_lang-UW5Pw3sx.js";import{_ as O}from"./Search.vue_vue_type_script_setup_true_lang-CrW3zCq9.js";import{_ as X}from"./Dialog.vue_vue_type_style_index_0_lang-gHtwBRrG.js";import"./index-C4QR_ydU.js";/* empty css               */import{_ as Z}from"./Table.vue_vue_type_script_lang-D1cnlJMr.js";/* empty css                    *//* empty css                  */import{g as ee,a as te,d as ae,s as le}from"./index-DUxsTLFE.js";import{u as re}from"./useTable-BfkNFnb-.js";import{_ as oe}from"./Write.vue_vue_type_script_setup_true_lang-C1WKQLSH.js";import{_ as se}from"./Detail.vue_vue_type_script_setup_true_lang-CHa8yP3g.js";import{u as ne}from"./useCrudSchemas-7vg1lRND.js";import{_ as d}from"./Button.vue_vue_type_script_setup_true_lang-CHmKy-t5.js";import{l as I}from"./element-plus-BKXXpGCF.js";import{q as ie,r as u,K as ue,P as l,Q as c,W as p,u as a,t as k,v as me,S as f,x as de,i as K,T as R,Y as T}from"./vue-chunks-BFNeukf4.js";import"./Icon-Bays4QVY.js";/* empty css                */import"./Form-D0JB84Bn.js";/* empty css               */import"./el-radio-button-i3wxWkyy.js";/* empty css                        *//* empty css                      *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-jY6LEONS.js";import"./style.css_vue_type_style_index_0_src_true_lang-EB6jvX6X.js";import"./wang-editor-B87DVY_Q.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-BU3jXQ-c.js";import"./IconPicker-WQjB0_MW.js";import"./useForm-CckQx6AC.js";import"./useIcon-BlE8AYSW.js";/* empty css                        *//* empty css                         *//* empty css                  */import"./index-CUts7MfX.js";import"./useValidator-Nt61Jv1p.js";import"./Descriptions-D1EBIYDt.js";import"./tree-Dgaev6Pi.js";const ce={class:"mb-10px"},et=ie({__name:"Department",setup(i){const o=u([]),{tableRegister:r,tableState:y,tableMethods:b}=re({fetchDataApi:()=>v(this,null,function*(){const{currentPage:e,pageSize:t}=y,s=yield te(U({pageIndex:a(e),pageSize:a(t)},a(V)));return{list:s.data.list,total:s.data.total}}),fetchDelApi:()=>v(this,null,function*(){return!!(yield ae(a(o)))})}),{loading:C,dataList:P,total:h,currentPage:n,pageSize:m}=y,{getList:$,getElTableExpose:q,delList:M}=b,V=u({}),N=e=>{V.value=e,$()},Q=ue([{field:"selection",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{type:"selection"}},{field:"index",label:"序号",type:"index",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0}},{field:"id",label:"部门名称",table:{slots:{default:e=>l(c,null,[e.row.departmentName])}},form:{component:"TreeSelect",componentProps:{nodeKey:"id",props:{label:"departmentName"}},optionApi:()=>v(this,null,function*(){return(yield ee()).data.list})},detail:{slots:{default:e=>l(c,null,[e.departmentName])}}},{field:"status",label:"状态",search:{hidden:!0},table:{slots:{default:e=>{const t=e.row.status;return l(c,null,[l(I,{type:t===0?"danger":"success"},{default:()=>[t===1?"启用":"禁用"]})])}}},form:{component:"Select",componentProps:{options:[{value:0,label:"禁用"},{value:1,label:"启用"}]}},detail:{slots:{default:e=>l(c,null,[l(I,{type:e.status===0?"danger":"success"},{default:()=>[e.status===1?"启用":"禁用"]})])}}},{field:"createTime",label:"创建时间",search:{hidden:!0},form:{hidden:!0}},{field:"remark",label:"备注",search:{hidden:!0},form:{component:"Input",componentProps:{type:"textarea",rows:5},colProps:{span:24}},detail:{slots:{default:e=>l(c,null,[e.remark])}}},{field:"action",width:"260px",label:"操作",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{slots:{default:e=>l(c,null,[l(d,{type:"primary",onClick:()=>B(e.row,"edit")},{default:()=>[p("编辑")]}),l(d,{type:"success",onClick:()=>B(e.row,"detail")},{default:()=>[p("详情")]}),l(d,{type:"danger",onClick:()=>z(e.row)},{default:()=>[p("删除")]})])}}}]),{allSchemas:w}=ne(Q),g=u(!1),x=u(""),S=u(null),_=u(""),W=()=>{x.value="新增",S.value=null,g.value=!0,_.value=""},A=u(!1),z=e=>v(this,null,function*(){const t=yield q();o.value=e?[e.id]:(t==null?void 0:t.getSelectionRows().map(s=>s.id))||[],A.value=!0,yield M(a(o).length).finally(()=>{A.value=!1})}),B=(e,t)=>{x.value=t==="edit"?"编辑":"详情",_.value=t,S.value=e,g.value=!0},L=u(),D=u(!1),Y=()=>v(this,null,function*(){const e=a(L),t=yield e==null?void 0:e.submit();t&&(D.value=!0,(yield le(t).catch(()=>{}).finally(()=>{D.value=!1}))&&(g.value=!1,n.value=1,$()))});return(e,t)=>(k(),me(c,null,[l(a(J),null,{default:f(()=>[l(a(O),{schema:a(w).searchSchema,onSearch:N,onReset:N},null,8,["schema"]),de("div",ce,[l(a(d),{type:"primary",onClick:W},{default:f(()=>[p("新增")]),_:1}),l(a(d),{loading:A.value,type:"danger",onClick:t[0]||(t[0]=s=>z(null))},{default:f(()=>[p(" 删除 ")]),_:1},8,["loading"])]),l(a(Z),{pageSize:a(m),"onUpdate:pageSize":t[1]||(t[1]=s=>K(m)?m.value=s:null),currentPage:a(n),"onUpdate:currentPage":t[2]||(t[2]=s=>K(n)?n.value=s:null),columns:a(w).tableColumns,data:a(P),loading:a(C),pagination:{total:a(h)},onRegister:a(r)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),l(a(X),{modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=s=>g.value=s),title:x.value},{footer:f(()=>[_.value!=="detail"?(k(),R(a(d),{key:0,type:"primary",loading:D.value,onClick:Y},{default:f(()=>[p(" 保存 ")]),_:1},8,["loading"])):T("",!0),l(a(d),{onClick:t[3]||(t[3]=s=>g.value=!1)},{default:f(()=>[p("关闭")]),_:1})]),default:f(()=>[_.value!=="detail"?(k(),R(oe,{key:0,ref_key:"writeRef",ref:L,"form-schema":a(w).formSchema,"current-row":S.value},null,8,["form-schema","current-row"])):T("",!0),_.value==="detail"?(k(),R(se,{key:1,"detail-schema":a(w).detailSchema,"current-row":S.value},null,8,["detail-schema","current-row"])):T("",!0)]),_:1},8,["modelValue","title"])],64))}});export{et as default};
