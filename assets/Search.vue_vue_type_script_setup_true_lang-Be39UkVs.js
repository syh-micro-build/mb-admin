var Q=Object.defineProperty;var A=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var W=(t,r,a)=>r in t?Q(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,D=(t,r)=>{for(var a in r||(r={}))Y.call(r,a)&&W(t,a,r[a]);if(A)for(var a of A(r))Z.call(r,a)&&W(t,a,r[a]);return t};var f=(t,r,a)=>new Promise((p,d)=>{var u=h=>{try{g(a.next(h))}catch(w){d(w)}},m=h=>{try{g(a.throw(h))}catch(w){d(w)}},g=h=>h.done?p(h.value):Promise.resolve(h.value).then(u,m);g((a=a.apply(t,r)).next())});import{i as ee,F as te}from"./Form-DpyPI9Kh.js";import{p as i,m as T,n as oe,o as se}from"./index-DZhlxyLR.js";import{u as ae}from"./useForm-CbWvYx-b.js";import{_ as E}from"./Button.vue_vue_type_script_setup_true_lang-Ch_pDWkR.js";import{u as V}from"./useIcon-DNC-mEk5.js";import{q as $,t as b,v as C,S as L,R as F,V as x,u as n,X as S,W as ne,P as z,r as v,d as O,O as y,w as ie,o as le,U as re}from"./vue-chunks-CrLAACUV.js";import{d as ce,s as de}from"./element-plus-Dmwbteg1.js";const q=$({__name:"ActionButton",props:{showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),visible:i.bool.def(!0),searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","expand"],setup(t,{emit:r}){const a=r,p=()=>{a("search")},d=()=>{a("reset")},u=()=>{a("expand")};return(m,g)=>(b(),C(z,null,[t.showSearch?(b(),L(n(E),{key:0,type:"primary",loading:t.searchLoading,icon:n(V)({icon:"ep:search"}),onClick:p},{default:F(()=>[x(" 查询 ")]),_:1},8,["loading","icon"])):S("",!0),t.showReset?(b(),L(n(E),{key:1,loading:t.resetLoading,plain:"",icon:n(V)({icon:"ep:refresh-right"}),onClick:d},{default:F(()=>[x(" 重置 ")]),_:1},8,["loading","icon"])):S("",!0),t.showExpand?(b(),L(n(E),{key:2,icon:n(V)({icon:t.visible?"ep:arrow-up":"ep:arrow-down"}),text:"",onClick:u},{default:F(()=>[x(ne(t.visible?"收起":"展开"),1)]),_:1},8,["icon"])):S("",!0)],64))}}),Re=$({__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:i.bool.def(!1),labelWidth:i.oneOfType([String,Number]).def("auto"),layout:i.string.validate(t=>["inline","bottom"].includes(t)).def("inline"),buttonPosition:i.string.validate(t=>["left","center","right"].includes(t)).def("center"),showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),expandField:i.string.def(""),inline:i.bool.def(!0),removeNoValueItem:i.bool.def(!0),model:{type:Object,default:()=>({})},searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","register","validate"],setup(t,{expose:r,emit:a}){const p=t,d=a,u=v(!0),m=v(p.model),g=O(()=>{const e=n(c);let o=ce(e.schema);if(e.showExpand&&e.expandField&&!n(u)){const s=T(o,l=>l.field===e.expandField);o.map((l,K)=>(K>=s?l.hidden=!0:l.hidden=!1,l))}return e.layout==="inline"&&(o=o.concat([{field:"action",formItemProps:{labelWidth:"0px",slots:{default:()=>y("div",null,[y(q,{showSearch:e.showSearch,showReset:e.showReset,showExpand:e.showExpand,searchLoading:e.searchLoading,resetLoading:e.resetLoading,visible:u.value,onExpand:M,onReset:I,onSearch:B},null)]),label:()=>y("span",null,[x(" ")])}}}])),o}),{formRegister:h,formMethods:w}=ae(),{getElFormExpose:R,getFormData:j,getFormExpose:U}=w,X=v({}),k=v({}),c=O(()=>{const e=D({},p);return Object.assign(e,n(k)),e}),G=(e={})=>{k.value=Object.assign(n(k),e),X.value=e},P=v([]);ie(()=>n(g),(...o)=>f(this,[...o],function*(e=[]){m.value=ee(e,n(m)),P.value=e}),{immediate:!0,deep:!0});const N=()=>f(this,null,function*(){const e=yield j();return n(c).removeNoValueItem?Object.keys(e).reduce((o,s)=>{const l=e[s];return oe(l)||(se(l)?Object.keys(l).length>0&&(o[s]=l):o[s]=l),o},{}):e}),B=()=>f(this,null,function*(){const e=yield R();yield e==null?void 0:e.validate(o=>f(this,null,function*(){if(o){const s=yield N();d("search",s)}}))}),I=()=>f(this,null,function*(){const e=yield R();e==null||e.resetFields();const o=yield N();d("reset",o)}),H=O(()=>({textAlign:n(c).buttonPosition})),M=()=>f(this,null,function*(){u.value=!n(u)}),_={getElFormExpose:R,setProps:G,setSchema:e=>{const{schema:o}=n(c);for(const s of o)for(const l of e)s.field===l.field&&de(s,l.path,l.value)},setValues:(...o)=>f(this,[...o],function*(e={}){m.value=Object.assign(p.model,n(m),e);const s=yield U();s==null||s.setValues(e)}),delSchema:e=>{const{schema:o}=n(c),s=T(o,l=>l.field===e);s>-1&&o.splice(s,1)},addSchema:(e,o)=>{const{schema:s}=n(c);if(o!==void 0){s.splice(o,0,e);return}s.push(e)},getFormData:j};le(()=>{d("register",_)}),r(_);const J=(e,o,s)=>{d("validate",e,o,s)};return(e,o)=>(b(),C(z,null,[y(n(te),{model:m.value,"is-custom":!1,"label-width":c.value.labelWidth,"hide-required-asterisk":"",inline:c.value.inline,"is-col":c.value.isCol,schema:P.value,onRegister:n(h),onValidate:J},null,8,["model","label-width","inline","is-col","schema","onRegister"]),t.layout==="bottom"?(b(),C("div",{key:0,style:re(H.value)},[y(q,{"show-reset":c.value.showReset,"show-search":c.value.showSearch,"show-expand":c.value.showExpand,"search-loading":c.value.searchLoading,"reset-loading":c.value.resetLoading,visible:u.value,onExpand:M,onReset:I,onSearch:B},null,8,["show-reset","show-search","show-expand","search-loading","reset-loading","visible"])],4)):S("",!0)],64))}});export{Re as _};
