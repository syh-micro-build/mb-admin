var j=Object.defineProperty;var E=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var F=(i,o,l)=>o in i?j(i,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[o]=l,U=(i,o)=>{for(var l in o||(o={}))G.call(o,l)&&F(i,l,o[l]);if(E)for(var l of E(o))H.call(o,l)&&F(i,l,o[l]);return i};var v=(i,o,l)=>new Promise((y,b)=>{var C=n=>{try{h(l.next(n))}catch(m){b(m)}},P=n=>{try{h(l.throw(n))}catch(m){b(m)}},h=n=>n.done?y(n.value):Promise.resolve(n.value).then(C,P);h((l=l.apply(i,o)).next())});import{_ as Q}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DcZkGUJO.js";import{_ as W}from"./Search.vue_vue_type_script_setup_true_lang-CEl_fCSC.js";import{_ as Y}from"./Dialog.vue_vue_type_style_index_0_lang-BvTf6JTc.js";import"./index-B8m1DCcH.js";/* empty css               */import{_ as Z}from"./Table.vue_vue_type_script_lang-C6kPEYDC.js";/* empty css                        *//* empty css                    *//* empty css                  */import{g as ee,a as te,d as ae,s as re}from"./index-Cgs80Gk7.js";import{u as le}from"./useTable-Bt3jlHM3.js";import{_ as oe}from"./Write.vue_vue_type_script_setup_true_lang-D7VUPWu3.js";import{_ as se}from"./Detail.vue_vue_type_script_setup_true_lang-DCP95koj.js";import{u as ne}from"./useCrudSchemas-B-xaNBdY.js";import{_ as d}from"./Button.vue_vue_type_script_setup_true_lang-D451fIGp.js";import{C as I}from"./element-plus-Dmwbteg1.js";import{q as ie,r as u,J as ue,O as r,P as p,V as c,u as a,t as k,v as me,R as f,x as de,i as q,S as D,X as V}from"./vue-chunks-CrLAACUV.js";import"./Icon-C_xGsnI1.js";/* empty css                */import"./Form-BnA0udkH.js";/* empty css                     *//* empty css               */import"./el-radio-button-C-Rnj1T4.js";/* empty css                        *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./InputPassword-dseFeR22.js";import"./style.css_vue_type_style_index_0_src_true_lang-BMQRWtaP.js";import"./wang-editor-FQ26JwTT.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-DAhjxTyq.js";import"./IconPicker-DLv5cb2d.js";/* empty css                      */import"./useForm-CnQ_DNHd.js";import"./useIcon-DYQA8GoJ.js";/* empty css                        *//* empty css                         *//* empty css                  */import"./index-lvZ0sBpj.js";import"./useValidator-Nt61Jv1p.js";import"./Descriptions-oU7IgGgJ.js";import"./tree-Dgaev6Pi.js";const pe={class:"mb-10px"},rt=ie({__name:"Department",setup(i){const o=u([]),{tableRegister:l,tableState:y,tableMethods:b}=le({fetchDataApi:()=>v(this,null,function*(){const{currentPage:e,pageSize:t}=y,s=yield te(U({pageIndex:a(e),pageSize:a(t)},a(T)));return{list:s.data.list,total:s.data.total}}),fetchDelApi:()=>v(this,null,function*(){return!!(yield ae(a(o)))})}),{loading:C,dataList:P,total:h,currentPage:n,pageSize:m}=y,{getList:$,getElTableExpose:J,delList:K}=b,T=u({}),N=e=>{T.value=e,$()},M=ue([{field:"selection",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{type:"selection"}},{field:"index",label:"序号",type:"index",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0}},{field:"id",label:"部门名称",table:{slots:{default:e=>r(p,null,[e.row.departmentName])}},form:{component:"TreeSelect",componentProps:{nodeKey:"id",props:{label:"departmentName"}},optionApi:()=>v(this,null,function*(){return(yield ee()).data.list})},detail:{slots:{default:e=>r(p,null,[e.departmentName])}}},{field:"status",label:"状态",search:{hidden:!0},table:{slots:{default:e=>{const t=e.row.status;return r(p,null,[r(I,{type:t===0?"danger":"success"},{default:()=>[t===1?"启用":"禁用"]})])}}},form:{component:"Select",componentProps:{options:[{value:0,label:"禁用"},{value:1,label:"启用"}]}},detail:{slots:{default:e=>r(p,null,[r(I,{type:e.status===0?"danger":"success"},{default:()=>[e.status===1?"启用":"禁用"]})])}}},{field:"createTime",label:"创建时间",search:{hidden:!0},form:{hidden:!0}},{field:"remark",label:"备注",search:{hidden:!0},form:{component:"Input",componentProps:{type:"textarea",rows:5},colProps:{span:24}},detail:{slots:{default:e=>r(p,null,[e.remark])}}},{field:"action",width:"260px",label:"操作",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{slots:{default:e=>r(p,null,[r(d,{type:"primary",onClick:()=>B(e.row,"edit")},{default:()=>[c("编辑")]}),r(d,{type:"success",onClick:()=>B(e.row,"detail")},{default:()=>[c("详情")]}),r(d,{type:"danger",onClick:()=>z(e.row)},{default:()=>[c("删除")]})])}}}]),{allSchemas:w}=ne(M),g=u(!1),x=u(""),S=u(null),_=u(""),O=()=>{x.value="新增",S.value=null,g.value=!0,_.value=""},R=u(!1),z=e=>v(this,null,function*(){const t=yield J();o.value=e?[e.id]:(t==null?void 0:t.getSelectionRows().map(s=>s.id))||[],R.value=!0,yield K(a(o).length).finally(()=>{R.value=!1})}),B=(e,t)=>{x.value=t==="edit"?"编辑":"详情",_.value=t,S.value=e,g.value=!0},L=u(),A=u(!1),X=()=>v(this,null,function*(){const e=a(L),t=yield e==null?void 0:e.submit();t&&(A.value=!0,(yield re(t).catch(()=>{}).finally(()=>{A.value=!1}))&&(g.value=!1,n.value=1,$()))});return(e,t)=>(k(),me(p,null,[r(a(Q),null,{default:f(()=>[r(a(W),{schema:a(w).searchSchema,onSearch:N,onReset:N},null,8,["schema"]),de("div",pe,[r(a(d),{type:"primary",onClick:O},{default:f(()=>[c("新增")]),_:1}),r(a(d),{loading:R.value,type:"danger",onClick:t[0]||(t[0]=s=>z(null))},{default:f(()=>[c(" 删除 ")]),_:1},8,["loading"])]),r(a(Z),{pageSize:a(m),"onUpdate:pageSize":t[1]||(t[1]=s=>q(m)?m.value=s:null),currentPage:a(n),"onUpdate:currentPage":t[2]||(t[2]=s=>q(n)?n.value=s:null),columns:a(w).tableColumns,data:a(P),loading:a(C),pagination:{total:a(h)},onRegister:a(l)},null,8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])]),_:1}),r(a(Y),{modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=s=>g.value=s),title:x.value},{footer:f(()=>[_.value!=="detail"?(k(),D(a(d),{key:0,type:"primary",loading:A.value,onClick:X},{default:f(()=>[c(" 保存 ")]),_:1},8,["loading"])):V("",!0),r(a(d),{onClick:t[3]||(t[3]=s=>g.value=!1)},{default:f(()=>[c("关闭")]),_:1})]),default:f(()=>[_.value!=="detail"?(k(),D(oe,{key:0,ref_key:"writeRef",ref:L,"form-schema":a(w).formSchema,"current-row":S.value},null,8,["form-schema","current-row"])):V("",!0),_.value==="detail"?(k(),D(se,{key:1,"detail-schema":a(w).detailSchema,"current-row":S.value},null,8,["detail-schema","current-row"])):V("",!0)]),_:1},8,["modelValue","title"])],64))}});export{rt as default};
