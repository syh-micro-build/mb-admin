var o=(l,w,r)=>new Promise((s,c)=>{var f=n=>{try{d(r.next(n))}catch(p){c(p)}},h=n=>{try{d(r.throw(n))}catch(p){c(p)}},d=n=>n.done?s(n.value):Promise.resolve(n.value).then(f,h);d((r=r.apply(l,w)).next())});import"./Table.vue_vue_type_script_lang-D-Hi_Hih.js";import"./index-a-hqsX_k.js";/* empty css                        *//* empty css                    *//* empty css                  */import{j as L,E as T}from"./element-plus-6v3c1uXT.js";import{r as m,w as y,u as a,o as b,n as x}from"./vue-chunks-DOWhatC1.js";const S=l=>{const{immediate:w=!0}=l,r=m(!1),s=m(1),c=m(10),f=m(0),h=m([]);y(()=>s.value,()=>{u.getList()}),y(()=>c.value,()=>{a(s)===1||(s.value=1),u.getList()}),b(()=>{w&&u.getList()});const d=m(),n=m(),p=(e,t)=>{d.value=e,n.value=a(t)},g=()=>o(void 0,null,function*(){yield x();const e=a(d);return e||console.error("The table is not registered. Please use the register method to register"),e}),u={getList:()=>o(void 0,null,function*(){r.value=!0;try{const e=yield l==null?void 0:l.fetchDataApi();e&&(h.value=e.list,f.value=e.total||0)}catch(e){}finally{r.value=!1}}),setProps:(...t)=>o(void 0,[...t],function*(e={}){const i=yield g();i==null||i.setProps(e)}),setColumn:e=>o(void 0,null,function*(){const t=yield g();t==null||t.setColumn(e)}),addColumn:(e,t)=>o(void 0,null,function*(){const i=yield g();i==null||i.addColumn(e,t)}),delColumn:e=>o(void 0,null,function*(){const t=yield g();t==null||t.delColumn(e)}),getElTableExpose:()=>o(void 0,null,function*(){return yield g(),a(n)}),refresh:()=>{u.getList()},delList:e=>o(void 0,null,function*(){const{fetchDelApi:t}=l;if(!t){console.warn("fetchDelApi is undefined");return}L.confirm("是否删除所选中数据？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>o(void 0,null,function*(){if(yield t()){T.success("删除成功");const v=a(f)%a(c)===e||a(c)===1?a(s)>1?a(s)-1:a(s):a(s);s.value=v,u.getList()}}))})};return{tableRegister:p,tableMethods:u,tableState:{currentPage:s,pageSize:c,total:f,dataList:h,loading:r}}};export{S as u};
