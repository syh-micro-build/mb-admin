var o=(l,w,r)=>new Promise((s,c)=>{var d=n=>{try{u(r.next(n))}catch(p){c(p)}},h=n=>{try{u(r.throw(n))}catch(p){c(p)}},u=n=>n.done?s(n.value):Promise.resolve(n.value).then(d,h);u((r=r.apply(l,w)).next())});import"./Table.vue_vue_type_script_lang-CNx8FBJ-.js";import"./index-fPquPYKy.js";/* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{p as T,e as C}from"./element-plus-BuBGixiZ.js";import{r as f,w as y,u as a,o as b,n as x}from"./vue-chunks-CaTGQ7j2.js";const z=l=>{const{immediate:w=!0}=l,r=f(!1),s=f(1),c=f(10),d=f(0),h=f([]);let u=!1;y(()=>s.value,()=>{u||m.getList(),u=!1}),y(()=>c.value,()=>{a(s)===1||(s.value=1,u=!0),m.getList()}),b(()=>{w&&m.getList()});const n=f(),p=f(),v=(e,t)=>{n.value=e,p.value=a(t)},g=()=>o(void 0,null,function*(){yield x();const e=a(n);return e||console.error("The table is not registered. Please use the register method to register"),e}),m={getList:()=>o(void 0,null,function*(){r.value=!0;try{const e=yield l==null?void 0:l.fetchDataApi();e&&(h.value=e.list,d.value=e.total||0)}catch(e){}finally{r.value=!1}}),setProps:(...t)=>o(void 0,[...t],function*(e={}){const i=yield g();i==null||i.setProps(e)}),setColumn:e=>o(void 0,null,function*(){const t=yield g();t==null||t.setColumn(e)}),addColumn:(e,t)=>o(void 0,null,function*(){const i=yield g();i==null||i.addColumn(e,t)}),delColumn:e=>o(void 0,null,function*(){const t=yield g();t==null||t.delColumn(e)}),getElTableExpose:()=>o(void 0,null,function*(){return yield g(),a(p)}),refresh:()=>{m.getList()},delList:e=>o(void 0,null,function*(){const{fetchDelApi:t}=l;if(!t){console.warn("fetchDelApi is undefined");return}T.confirm("是否删除所选中数据？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>o(void 0,null,function*(){if(yield t()){C.success("删除成功");const L=a(d)%a(c)===e||a(c)===1?a(s)>1?a(s)-1:a(s):a(s);s.value=L,m.getList()}}))})};return{tableRegister:v,tableMethods:m,tableState:{currentPage:s,pageSize:c,total:d,dataList:h,loading:r}}};export{z as u};
